# **客户端训练营课题日报**

 **项目名称**：Project "Persona" —— AI 驱动的下一代社交网络
报告日期：2025年11月24日
开发负责人：AntiFan
技术栈：Android (Kotlin) / Jetpack Compose / MVVM / Room / Hilt / Retrofit

### 一、 项目概况 

  **截止今日，项目已完成**基础筛选需求（Basic Requirements）**的** **90%**，整体课题进度（含进阶挑战）约为 **65%**。

  **目前项目已成功构建了完整的 MVP（最小可行性产品）闭环。应用已具备“角色创作”、“端云协同对话”、“社交内容生产”、“社交互动”四大核心能力。底层架构采用 MVVM 模式，通过 Hilt 实现依赖注入，数据层实现了基于 Room 的离线优先（Offline-first）策略，能够从本地 Mock 模式无缝切换至真实云端 AI 服务。**

---

### 二、 今日工作汇报 

**今日重点攻克了** **P3 级 AI 融合应用** **中的 API 连通性问题，并完成了** **P2 级数据持久化** **在社交广场业务场景下的落地。**

* **修复网络层关键缺陷**：解决了云端大模型调用失败的问题，打通了 App 与火山引擎的通信链路。
* **构建社交广场 (Social Feed) 模块**：

  * **设计并实现了** **Post**（动态）与 **PostWithAuthor**（动态与作者联合查询）的数据库模型。
* **完成了首页架构重构，从单一列表升级为“广场 + 通讯录”的双 Tab 导航结构。**
* **实现 AI 内容生产业务逻辑**：

  * **在角色详情页增加了“触发动态”入口，实现了调用 AI 模拟角色人设自动生成图文动态，并同步至社交广场的完整链路。**
* **实现社交交互系统**：

  * **完成了“点赞”与“关注”功能的开发，涵盖 UI 交互、ViewModel 状态管理及底层数据库的原子化更新。**

---

### 三、 工作亮点 

* **极致的用户体验优化 (Optimistic UI)**：

  * **在处理“点赞”与“关注”交互时，采用了**乐观更新 (Optimistic Update) **策略。即 UI 层先行响应用户的点击操作（瞬间变色/数字变化），后台异步执行数据库写入。这极大地消除了 IO 操作带来的延迟感，提供了丝滑的操作体验。**
* **高阶数据库查询设计**：

  * **在 Room 数据库设计中，摒弃了低效的循环查询，利用** **@Relation** **和** **INNER JOIN** **实现了** **Post** **表与** **Persona** **表的联合查询，一次性获取动态内容及其作者的头像、昵称和关注状态，显著提升了列表渲染性能。**
* **工程化架构演进**：

  * **遵循开闭原则，通过版本迁移（Database Version 1 -> 3）平滑升级了数据库结构。在 ViewModel 层通过** **StateFlow** **实现了数据驱动 UI，确保了数据的一致性与可观测性。**

---

### 四、 问题攻坚与解决方案 (Problem Solving)

**问题 1：云端 AI 接口响应 HTTP 500 错误**

* **现象**：Retrofit 请求发送成功，但服务器持续返回 500 Internal Server Error。
* **排查思路**：排除网络连接问题后，对比官方文档与控制台配置，发现 Endpoint ID 关联的是“文生图”模型，而代码调用的是文本对话接口 (**chat/completions**)，导致参数格式不兼容。
* **解决方案**：在火山引擎控制台重新部署 **Doubao-lite-32k** **(文本大模型)，获取新的 Endpoint ID 并替换至** **NetworkModule** **中，成功解决问题。**

**问题 2：Kapt 编译失败与依赖冲突**

* **现象**：在引入 Room 新表结构后，编译出现大量 **Symbol not found** **及** **Object cannot be cast to Annotation** **错误。**
* **解决方案**：识别为 Room 依赖配置缺失及 Kapt 缓存脏数据导致。在 **build.gradle.kts** **中补全了** **androidx.room:room-compiler** **等缺失依赖，并执行** **Clean Project** **清理构建缓存，恢复正常编译。**

---

### 五、 剩余工作规划 

**根据《课题作业要求》，基础功能仅剩一项核心业务待完成，随后将进入进阶挑战环节。**

* **P0 级 - 基础补全（优先级：最高）**：

  * **Persona 共生 (Symbiosis)**：实现聊天记录反哺角色设定。即通过对话分析，动态更新角色的 **personality** **字段，实现“越聊越懂你”的养成感。**
* **P3 级 - 进阶挑战（优先级：高）**：

  * **体验优化**：引入 Markdown 渲染库优化富文本显示；实现 AI 回复的“流式打字机”效果。
* **端侧模型**：调研 Google MediaPipe 或 MLC LLM，尝试在端侧部署轻量级模型，实现无网环境下的私密聊天。
* **文档与交付**：

  * **撰写《深度项目报告》，重点复盘端云协同架构的设计决策。**
